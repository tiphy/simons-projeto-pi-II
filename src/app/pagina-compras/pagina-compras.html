<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="/src/app/pagina-compras/pagina-compras.css" rel="stylesheet">
    <link type="image/x-icon" href="/public/images/as-logo.png" rel="shortcut icon">

    <title>Detalhes do Produto</title>
</head>
<body>
    <div class="cabecalho">
        <header>
            <img src="/public/images/simons-logo.png" alt="logo da marca" style=" width: 160px; margin-left: 50px;">

            <nav>
                <ul>
                    <li><a href="/src/app/pagina-camisetas/pagina-camisetas.html">camisetas</a></li>
                    <li><a href="/src/app/pagina-social-cliente/pagina-social-cliente.html">social</a></li>
                </ul>
            </nav>

            <div class="trio">
                <button class="login" onclick="login()">Login</button>
                <img class="img-cabecalho" src="/public/images/carrinho.png" alt="carrinho" onclick="irParaCarrinho()" style="cursor: pointer;">
                <img class="img-cabecalho" src="/public/images/lupa.png" alt="imagem da lupa">
                <img class="img-cabecalho" src="/public/images/tres-pontos.png" alt="imagem da lupa">
            </div> 
        </header>
    </div>

    <section>
        <div class="voltar-links">
            <div class="margem">
                <ul>
                    <li><a href="/src/app/pagina-home/pagina-home.html" style="font-weight: 100;">pagina inicial ></a></li>
                    <li><a href="/src/app/pagina-camisetas/pagina-camisetas.html" style="font-weight: 100;">camisetas ></a></li>
                    <li><a href="#" style="font-weight: 100;"> detalhes</a></li>
                </ul>
            </div>
        </div>
    </section>

    <section>
        <div class="titulo">
            <h1 id="detalhe-titulo-topo">Carregando...</h1>
        </div>
        <hr class="linha-titulo">
    </section>

    <section>
        
        <div class="img-canto">
            <img class="img-camiseta" src="/public/images/simons.png" alt="imagem">
            <img class="img-camiseta" src="/public/images/simons.png" alt="imagem">
            <img class="img-camiseta" src="/public/images/simons.png" alt="imagem">
        </div>

        <div class="img-principal">
             <img class="camiseta" id="detalhe-imagem" src alt="imagem do produto">
        </div>

        <div class="textos-primeiros">
            <h3 id="detalhe-nome" style="font-size: 25px; margin-top: 5px;">...</h3>
            <h4 id="detalhe-preco" style="margin-top: -15px; font-weight: 100;">...</h4>

            <hr>

            <p id="detalhe-descricao">Produto de alta qualidade, confeccionado com os melhores materiais para garantir conforto e estilo.</p>

            <hr>
            <pre>Cores disponiveis: </pre>
        </div>

        <div class="cores">
            <img class="camiseta-cores" src="/public/images/alice-azul.png" alt="cor">
            <img class="camiseta-cores" src="/public/images/alice-azul.png" alt="cor">
        </div>

        <div class="textos-secundarios">
            <hr>
            <pre>Escolha seu tamanho:</pre>
        </div>

        <div class="tamanhos">
            <div class="fundo-tamanho"><h6>PP</h6></div>
            <div class="fundo-tamanho"><h6>P</h6></div>
            <div class="fundo-tamanho"><h6>M</h6></div>
            <div class="fundo-tamanho"><h6>G</h6></div>
            <div class="fundo-tamanho"><h6>GG</h6></div>
        </div>

        <div>
            <button class="botoes" onclick="pagamento()" style="background-color: #e6fadd; box-shadow: 0 4px 8px #c8ddbf;">Comprar</button>
            <button class="botoes" onclick="carrinho()">Adicionar ao carrinho</button>
        </div>

    </section>

    <section>
        <div class="passagem-tempo">
            <hr class="linha">
            <h4 class="texto-passagem">Você também pode gostar</h4>
            <hr class="linha-dois">
        </div>
    </section>

    <section>
        <div class="central">
            <div class="produto">
                <img class="camiseta-img" src="/public/images/gemeas.png" alt="camiseta gemeas">
                <div class="titulo-camiseta">
                    <h3 style="font-weight: 500; ">Camiseta Gêmeas</h3>
                    <h4 style="font-weight: 100; margin-top: -15px;">R$ 59,90</h4>
                </div>
                <hr class="linha-camiseta">
                <button class="botao" onclick="carrinho()">Adicionar ao carrinho</button>
            </div>
            
            <div class="produto">
                <img class="camiseta-img" src="/public/images/amanda-pb.png" alt="camiseta pb" style="width: 230px;">
                <div class="titulo-camiseta">
                    <h3 style="font-weight: 500; ">Camiseta Gêmeas</h3>
                    <h4 style="font-weight: 100; margin-top: -15px;">R$ 59,90</h4>
                </div>
                <hr class="linha-camiseta">
                <button class="botao" onclick="carrinho()">Adicionar ao carrinho</button>
            </div>
        </div>
    </section>

    <footer> oi </footer>

    <script src="/src/js/gerenciador.js"></script>
    <script src="/src/js/auth.js"></script>

    <script src="/src/js/auth.js"></script>
    <script src="/src/js/gerenciador.js"></script>

    <script>
        // 1. Recuperar o ID do produto que o cliente clicou
        const idSelecionado = localStorage.getItem('produtoSelecionadoID');
        const produtos = lerProdutos();
        
        // Variável global para guardar o produto que está na tela
        let produtoAtual = null;

        // 2. Encontrar o produto na lista e preencher a tela
        const produto = produtos.find(p => p.id == idSelecionado);

        if (produto) {
            produtoAtual = produto; // <--- IMPORTANTE: Guarda o produto aqui!
            
            // Preenche as informações visuais
            const imgPrincipal = document.getElementById('detalhe-imagem');
            if(imgPrincipal) imgPrincipal.src = produto.imagem;
            
            document.querySelectorAll('.img-camiseta, .camiseta-cores').forEach(img => img.src = produto.imagem);
            
            const tituloTopo = document.getElementById('detalhe-titulo-topo');
            if(tituloTopo) tituloTopo.innerText = produto.nome;

            const tituloNome = document.getElementById('detalhe-nome');
            if(tituloNome) tituloNome.innerText = produto.nome;
            
            let precoFormatado = parseFloat(produto.preco).toFixed(2).replace('.', ',');
            const detalhePreco = document.getElementById('detalhe-preco');
            if(detalhePreco) detalhePreco.innerText = "R$ " + precoFormatado;

            document.title = produto.nome + " | Simons";
        } else {
            // Se não achar o produto, volta para a loja
            window.location.href = "/src/app/pagina-camisetas/pagina-camisetas.html";
        }

        // --- FUNÇÕES DOS BOTÕES (AQUI ESTÁ A CORREÇÃO) ---

        function carrinho() {
            if (produtoAtual) {
                // Chama a função do gerenciador.js que salva no banco
                adicionarAoCarrinho(produtoAtual);
            } else {
                alert("Erro: Produto não carregado corretamente.");
            }
        }

        function pagamento() {
            if (produtoAtual) {
                adicionarAoCarrinho(produtoAtual);
                // Redireciona para o carrinho
                window.location.href = "/src/app/pagina-carrinho/pagina-carrinho.html";
            }
        }
    </script>
</body>
</html>